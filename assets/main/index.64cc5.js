System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){"use strict";var i,o,e,t;return{setters:[function(n){i=n.createClass},function(n){o=n.cclegacy,e=n.assert,t=n.clamp01}],execute:function(){o._RF.push({},"462feKmdu1GGLeEvAErIJpJ","AudioManager",void 0);var u=n("AudioManager",function(){function n(){}var o=n.prototype;return o.init=function(i){n._audioSource=i},o.playMusic=function(i){var o=n._audioSource;e(o,"AudioManager not inited!"),o.loop=i,o.playing||o.play()},o.stopMusic=function(){var i=n._audioSource;e(i,"AudioManager not inited!"),i.playing&&i.stop()},o.playSound=function(i,o){void 0===o&&(o=1);var t=n._audioSource;e(t,"AudioManager not inited!"),t.playOneShot(i,o)},o.setMusicVolume=function(i){var o=n._audioSource;e(o,"AudioManager not inited!"),i=t(i),o.volume=i},i(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}());u._instance=void 0,u._audioSource=void 0,o._RF.pop()}}}));

System.register("chunks:///_virtual/AudioMng.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){"use strict";var e,o,t,r,u,n,a,l,p,d;return{setters:[function(i){e=i.applyDecoratedDescriptor,o=i.inheritsLoose,t=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){u=i.cclegacy,n=i._decorator,a=i.AudioSource,l=i.AudioClip,p=i.CCBoolean,d=i.Component}],execute:function(){var c,b,s,y,h,A,f,m,S,g,v,z,O,w,_,k,B,M,T,C,D,L,P,F,I,R,Z,j;u._RF.push({},"49e84lrEqZCa5bwTGMZTzDr","AudioMng",void 0);var q=n.ccclass,x=n.property;i("default",(c=x({type:a}),b=x({type:l}),s=x({type:l}),y=x({type:l}),h=x({type:l}),A=x({type:l}),f=x({type:l}),m=x({type:l}),S=x({type:l}),g=x({type:l}),v=x({type:l}),z=x({type:l}),O=x(p),q((k=e((_=function(i){function e(){for(var e,o=arguments.length,u=new Array(o),n=0;n<o;n++)u[n]=arguments[n];return e=i.call.apply(i,[this].concat(u))||this,t(e,"audioSource",k,r(e)),t(e,"binAudio",B,r(e)),t(e,"shootAudio",M,r(e)),t(e,"playerMoveAudio",T,r(e)),t(e,"tankBombAudio",C,r(e)),t(e,"campBombAudio",D,r(e)),t(e,"gameOverAudio",L,r(e)),t(e,"gameStartAudio",P,r(e)),t(e,"binTankAudio",F,r(e)),t(e,"addLifeAudio",I,r(e)),t(e,"propOutAudio",R,r(e)),t(e,"getPropAudio",Z,r(e)),t(e,"enableAudio",j,r(e)),e.playerMoveID=void 0,e}o(e,i);var u=e.prototype;return u.playAudio=function(i,e){this.enableAudio&&("bin"==i?this.audioSource.playOneShot(this.binAudio):"bin_tank"==i?this.audioSource.playOneShot(this.binTankAudio):"shoot"==i?this.audioSource.playOneShot(this.shootAudio):"player_move"==i?(this.audioSource.clip=this.playerMoveAudio,this.audioSource.loop=!0,this.audioSource.volume=.8,this.audioSource.playing||this.audioSource.play()):"tank_bomb"==i?this.audioSource.playOneShot(this.tankBombAudio):"game_over"==i?this.audioSource.playOneShot(this.gameOverAudio):"game_start"==i?this.audioSource.playOneShot(this.gameStartAudio):"camp_bomb"==i?this.audioSource.playOneShot(this.campBombAudio):"add_life"==i?this.audioSource.playOneShot(this.addLifeAudio):"get_prop"==i?this.audioSource.playOneShot(this.getPropAudio):"prop_out"==i&&this.audioSource.playOneShot(this.propOutAudio))},u.stopAudio=function(i){this.enableAudio&&"player_move"==i&&this.audioSource.stop()},e}(d)).prototype,"audioSource",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(_.prototype,"binAudio",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(_.prototype,"shootAudio",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(_.prototype,"playerMoveAudio",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=e(_.prototype,"tankBombAudio",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(_.prototype,"campBombAudio",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(_.prototype,"gameOverAudio",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(_.prototype,"gameStartAudio",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(_.prototype,"binTankAudio",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(_.prototype,"addLifeAudio",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(_.prototype,"propOutAudio",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(_.prototype,"getPropAudio",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(_.prototype,"enableAudio",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),w=_))||w));u._RF.pop()}}}));

System.register("chunks:///_virtual/BaseTank.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Globals.ts","./Utils.ts","./AudioMng.ts"],(function(o){"use strict";var i,t,e,n,s,a,r,l,f,c,u,h,d,p;return{setters:[function(o){i=o.inheritsLoose,t=o.createForOfIteratorHelperLoose},function(o){e=o.cclegacy,n=o._decorator,s=o.UITransform,a=o.find,r=o.Animation,l=o.math,f=o.Rect,c=o.Component},function(o){u=o.Dir,h=o.Globals},function(o){d=o.adjustNumber},function(o){p=o.default}],execute:function(){var v,m;e._RF.push({},"316c1nUDDRM/q1i/hQFDYCR","BaseTank",void 0);var g=n.ccclass;o("default",g(((m=function(o){function e(){for(var i,t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(i=o.call.apply(o,[this].concat(e))||this).bulletCount=void 0,i.isEnemy=void 0,i.level=void 0,i.dir=void 0,i.blood=void 0,i.life=void 0,i.canMove=void 0,i.autoMoving=void 0,i.mapLayer=void 0,i.uiCom=void 0,i.isProp=void 0,i.isStar=void 0,i._audioMng=null,i._anim=null,i}i(e,o);var n=e.prototype;return n.onLoad=function(){this.level=0,this.dir=u.LEFT,this.blood=1,this.canMove=!1,this.autoMoving=!1,this.isEnemy=!0,this.isProp=!1,this.isStar=!1,this.bulletCount=1,this.uiCom=this.getComponent(s),this._audioMng=a("/Game/AudioMng").getComponent(p),this._anim=this.getComponent(r)},n.onUpdate=function(o){},n.pause=function(){this.canMove=!1},n.resume=function(){this.canMove=!0},n._isCollisionWithMap=function(){var o=this.node,i=h.TANK_SIZE/2;return o.position.x-i<0||o.position.x+i>h.MAP_WIDTH||o.position.y+i>h.MAP_HEIGHT||o.position.y-i<0},n._fastIsDirCollisionWithBlock=function(o){for(var i,n=Math.floor(this.node.position.x/h.BLOCK_SIZE),s=Math.floor(this.node.position.y/h.BLOCK_SIZE),a=this.uiCom.getBoundingBox(),r=t(e.offsetMap.get(o));!(i=r()).done;){var f=i.value,c=f.lineOffset,u=f.colOffset,d=l.clamp(s+c,0,25),p=l.clamp(n+u,0,25),v=this.mapLayer.blockTrans[d][p];if(v){var m=v.getBoundingBox(),g=v.node;if(g.active&&("block_wall"==g.name||"block_stone"==g.name||"camp"==g.name||"block_river"==g.name)&&a.intersects(m))return!0}}return!1},n._fastIsCollisionWithBlock=function(){for(var o=Math.floor(this.node.position.x/h.BLOCK_SIZE),i=Math.floor(this.node.position.y/h.BLOCK_SIZE),t=this.uiCom.getBoundingBox(),e=-1;e<=1;e++)for(var n=-1;n<=1;n++){var s=l.clamp(i+e,0,25),a=l.clamp(o+n,0,25),r=this.mapLayer.blockTrans[s][a];if(r){var f=r.getBoundingBox(),c=r.node;if(c.active&&("block_wall"==c.name||"block_stone"==c.name||"camp"==c.name||"block_river"==c.name)&&t.intersects(f))return!0}}return!1},n._isCollisionWithBlock=function(){return this._fastIsDirCollisionWithBlock(this.dir)},n._isCollisionWithTank=function(){var o=this.uiCom.getBoundingBox(),i=this.mapLayer.enemies.children,n=this.mapLayer.players.children;switch(this.dir){case u.LEFT:o=new f(o.xMin-1,o.yMin+1,1,o.height-1);break;case u.RIGHT:o=new f(o.xMax,o.yMin+1,1,o.height-1);break;case u.UP:o=new f(o.xMin+1,o.yMax,o.width-1,1);break;case u.DOWN:o=new f(o.xMin+1,o.yMin-1,o.width-1,1)}for(var a,r=t(i);!(a=r()).done;){var l=a.value,c=l.getComponent(e);if(l!=this.node&&c.blood>0&&!c.isStar&&o.intersects(l.getComponent(s).getBoundingBox()))return!0}for(var h,d=t(n);!(h=d()).done;){var p=h.value,v=p.getComponent(e);if(p!=this.node&&v.blood>0&&!v.isStar&&o.intersects(p.getComponent(s).getBoundingBox()))return!0}return!1},n._adjustPosition=function(){var o=d(this.node.position.x),i=d(this.node.position.y);this.node.setPosition(o,i)},e}(c)).offsetMap=new Map([[u.UP,[{lineOffset:1,colOffset:-1},{lineOffset:1,colOffset:0},{lineOffset:1,colOffset:1}]],[u.DOWN,[{lineOffset:-1,colOffset:-1},{lineOffset:-1,colOffset:0},{lineOffset:-1,colOffset:1}]],[u.LEFT,[{lineOffset:-1,colOffset:-1},{lineOffset:0,colOffset:-1},{lineOffset:1,colOffset:-1}]],[u.RIGHT,[{lineOffset:-1,colOffset:1},{lineOffset:0,colOffset:1},{lineOffset:1,colOffset:1}]]]),v=m))||v);e._RF.pop()}}}));

System.register("chunks:///_virtual/BlockCamp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Game.ts","./AudioMng.ts"],(function(e){"use strict";var t,r,n,o,i,a,c,s,u,p,l,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,a=e._decorator,c=e.SpriteFrame,s=e.Sprite,u=e.find,p=e.Component},function(e){l=e.default},function(e){d=e.default}],execute:function(){var f,m,y,g;i._RF.push({},"b6e1e7FOQRC3YLYQ/e7CpcO","BlockCamp",void 0);var h=a.ccclass,v=a.property;e("default",(f=v(c),h((g=t((y=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,n(t,"destoryed",g,o(t)),t}return r(t,e),t.prototype.tryDestory=function(){l.single().gameover||(this.getComponent(s).spriteFrame=this.destoryed,u("/Game/AudioMng").getComponent(d).playAudio("camp_bomb"),u("/Game").getComponent(l).gameOver())},t}(p)).prototype,"destoryed",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=y))||m));i._RF.pop()}}}));

System.register("chunks:///_virtual/BlockWall.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var n,e,i,r,o,c;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,r=t.UITransformComponent,o=t.Rect,c=t.Component}],execute:function(){var s;e._RF.push({},"a19f4RUjpZFParDJKKr3Jg1","BlockWall",void 0);var a=i.ccclass;t("default",a(s=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var i=e.prototype;return i.init=function(){for(var t=this.node.children,n=0;n<t.length;n++)t[n].active=!1;this.node.active=!0},i.tryDestory=function(t){for(var n=!1,e=this.node.children,i=this.node.position,c=0;c!=e.length;c++){var s=e[c].getComponent(r).getBoundingBox(),a=new o(s.xMin+i.x,s.yMin+i.y,s.xMax-s.xMin,s.yMax-s.yMin);!e[c].active&&a.intersects(t)&&(e[c].active=!0,n=!0)}return this._isDestory()&&(this.node.active=!1),n},i._isDestory=function(){for(var t=this.node.children,n=0;n!=t.length;n++)if(!t[n].active)return!1;return!0},e}(c))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Globals.ts","./BlockWall.ts","./BlockCamp.ts","./AudioMng.ts"],(function(i){"use strict";var t,o,e,n,s,a,r,l,u,h,c,p,d,m,f,v,y,B,g,L,_;return{setters:[function(i){t=i.applyDecoratedDescriptor,o=i.inheritsLoose,e=i.initializerDefineProperty,n=i.assertThisInitialized,s=i.createForOfIteratorHelperLoose},function(i){a=i.cclegacy,r=i._decorator,l=i.SpriteFrame,u=i.UITransform,h=i.find,c=i.v3,p=i.Sprite,d=i.Animation,m=i.math,f=i.Rect,v=i.Component},function(i){y=i.Dir,B=i.Globals},function(i){g=i.default},function(i){L=i.default},function(i){_=i.default}],execute:function(){var C,E,k,T;a._RF.push({},"268889tN/hPk4y6USlp0geL","Bullet",void 0);var b=r.ccclass,M=r.property;i("default",(C=M([l]),b((T=t((k=function(i){function t(){for(var t,o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t=i.call.apply(i,[this].concat(s))||this,e(t,"frames",T,n(t)),t.tank=void 0,t.isEnemy=void 0,t.dir=void 0,t.step=void 0,t.stopMoving=void 0,t.mapLayer=void 0,t.uiCom=void 0,t.level=void 0,t.audioMng=void 0,t}o(t,i);var a=t.prototype;return a.onLoad=function(){this.uiCom=this.getComponent(u),this.audioMng=h("/Game/AudioMng").getComponent(_),this.mapLayer=h("/Canvas/GameLayer/MapLayer").getComponent("MapLayer")},a.init=function(i,t,o,e,n){switch(void 0===n&&(n=0),this.tank=e,this.tank.bulletCount--,this.isEnemy=e.isEnemy,this.dir=i,this.step=o,this.stopMoving=!1,this.level=n,t=c(t),this.dir){case y.LEFT:t.x-=B.BULLET_SIZE;break;case y.UP:t.y+=B.BULLET_SIZE;break;case y.RIGHT:t.x+=B.BLOCK_SIZE;break;case y.DOWN:t.y-=B.BLOCK_SIZE}this.node.position=t,this.getComponent(p).spriteFrame=this.frames[this.dir]},a.onBulletDestory=function(){this.stopMoving=!0,this.mapLayer.destoryBullet(this.node)},a.onUpdate=function(i){if(!this.stopMoving){var t=50*this.step*i,o=this.node.position,e=o.x,n=o.y;switch(this.dir){case y.LEFT:e-=t;break;case y.UP:n+=t;break;case y.RIGHT:e+=t;break;case y.DOWN:n-=t}this.node.setPosition(e,n),this._isCollisionWithMap()||this._isCollisionWithBlock()||this._isCollisionWithTank()?(this.stopMoving=!0,this.tank.bulletCount++,this._playAnimation()):this._isCollisionWithBullet()&&(this.tank.bulletCount++,this.onBulletDestory())}},a._playAnimation=function(){this.getComponent(d).play("bomb")},a._stopAnimation=function(){this.getComponent(d).stop()},a._isCollisionWithMap=function(){var i=this.node,t=B.BULLET_SIZE/2;return(i.position.x-t<0||i.position.x+t>B.MAP_WIDTH||i.position.y+t>B.MAP_HEIGHT||i.position.y-t<0)&&(this.isEnemy||this.audioMng.playAudio("bin",!1),!0)},a._fastIsCollisionWithBlock=function(i){for(var t=0,o=Math.floor(this.node.position.x/B.BLOCK_SIZE),e=Math.floor(this.node.position.y/B.BLOCK_SIZE),n=-1;n<=1;n++)for(var s=-1;s<=1;s++){var a=m.clamp(e+n,0,25),r=m.clamp(o+s,0,25),l=this.mapLayer.blockTrans[a][r];if(l){var u=l.node;if(!u.active)continue;var h=l.getBoundingBox();i.intersects(h)&&("block_wall"==u.name?this.level<B.TB_STONE_POWER?u.getComponent(g).tryDestory(i)&&t++:(u.active=!1,t++):"block_stone"==u.name?(this.isEnemy||(this.level<B.TB_STONE_POWER?this.audioMng.playAudio("bin",!1):u.active=!1),t++):"camp"==u.name?(u.getComponent(L).tryDestory(),t++):"block_forest"==u.name&&this.level>=B.TB_FOREST_POWER&&(u.active=!1))}}return t},a._isCollisionWithBlock=function(){this.mapLayer.blocks.children;var i=this.uiCom.getBoundingBox();switch(this.dir){case y.LEFT:case y.RIGHT:i=new f(i.xMin,i.yMin-B.BULLET_SIZE,B.BULLET_SIZE,3*B.BULLET_SIZE);break;case y.UP:case y.DOWN:i=new f(i.xMin-B.BULLET_SIZE,i.yMin,3*B.BULLET_SIZE,B.BULLET_SIZE)}return this._fastIsCollisionWithBlock(i)},a._isCollisionWithTank=function(){var i=this.uiCom.getBoundingBox();if(this.isEnemy)for(var t,o=this.mapLayer.players.children,e=s(o);!(t=e()).done;){var n=t.value.getComponent("PlayerTank");if(i.intersects(n.uiCom.getBoundingBox())&&n.blood>0&&!n.isStar)return n.disBlood(),!0}else for(var a,r=this.mapLayer.enemies.children,l=s(r);!(a=l()).done;){var u=a.value.getComponent("EnemyTank");if(i.intersects(u.uiCom.getBoundingBox())&&u.blood>0&&!u.isStar)return u.disBlood(),!0}return!1},a._isCollisionWithBullet=function(){var i,o=this.uiCom.getBoundingBox();if(!this.isEnemy){i=this.mapLayer.enemiesBullets.children;for(var e=0;e!=i.length;e++){var n=i[e].getComponent(t);if(o.intersects(n.uiCom.getBoundingBox())&&!n.stopMoving)return n.stopMoving=!0,n.onBulletDestory(),n.tank.bulletCount++,!0}}return!1},t}(v)).prototype,"frames",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=k))||E));a._RF.pop()}}}));

System.register("chunks:///_virtual/EnemyTank.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseTank.ts","./Globals.ts","./Game.ts"],(function(i){"use strict";var t,s,n,e,o,a,h,l,r,c;return{setters:[function(i){t=i.inheritsLoose},function(i){s=i.cclegacy,n=i._decorator,e=i.find,o=i.Animation,a=i.v3},function(i){h=i.default},function(i){l=i.Dir,r=i.Globals},function(i){c=i.default}],execute:function(){var u;s._RF.push({},"035fa9CaO9AMKW83csyRyYC","EnemyTank",void 0);var d=n.ccclass;n.property,i("default",d(u=function(i){function s(){for(var t,s=arguments.length,n=new Array(s),e=0;e<s;e++)n[e]=arguments[e];return(t=i.call.apply(i,[this].concat(n))||this)._maxDistance=100,t._curDistance=0,t}t(s,i);var n=s.prototype;return n.onLoad=function(){i.prototype.onLoad.call(this),this.mapLayer=e("/Canvas/GameLayer/MapLayer").getComponent("MapLayer")},n.onUpdate=function(i){if(this.canMove&&!this.mapLayer.isAIPaused()){var t=(36+6*(2==this.level?1:0))*i;this._autoMoving(t)}},n.init=function(i){var t=this;this._curDistance=0,this.level=c.single().getRandInt(1,5),this.blood=4==this.level?3:1,this.isProp=this.level>=5,this.isStar=!0,this.node.position=i,this.getComponent(o).play("star"),c.single().scheduleForever((function(){t._curDistance>=t._maxDistance&&(t._curDistance=0,t.changeDir())}),this,.2),c.single().scheduleForever((function(){t.canMove&&!t.mapLayer.isAIPaused()&&(c.single().getRandom()>.5&&t.shoot())}),this,.5),c.single().unscheduleCallBackForTarget(this.afterStar,this),c.single().scheduleOne(this.afterStar,this,.6)},n.afterStar=function(){this.isStar=!1,this.setDir(l.DOWN),this.playAnimation("idle"),this.mapLayer.isAIPaused()||(this.canMove=!0)},n.pause=function(){this.canMove&&this.blood>0&&this.playAnimation("idle"),this.canMove=!1},n.resume=function(){this.blood>0&&(this.canMove=!0,this.playAnimation("moving"))},n.setDir=function(i){if(this.dir!=i){var t=a(this.node.position);this._adjustPosition(),(this._isCollisionWithMap()||this._isCollisionWithBlock()||this._isCollisionWithTank())&&(this.node.position=t,this._curDistance=this._maxDistance),this.dir=i,this.node.angle=-90*this.dir}},n.changeDir=function(){if(this.canMove){var i=c.single().getRandom();i<.4?this.setDir(l.DOWN):i<.6?this.setDir(l.LEFT):i<.8?this.setDir(l.UP):this.setDir(l.RIGHT),this.playAnimation("moving")}},n.shoot=function(){this.mapLayer.createBullet(this.dir,this.node.position,Math.min(4,this.level),this)},n.playAnimation=function(i){var t=i+"_0_"+this.level;4==this.level&&(t=i+"_0_"+this.level+"_"+(3-this.blood)),this.getComponent(o).play(t)},n.stopAnimation=function(){this.getComponent(o).stop()},n.disBlood=function(i){void 0===i&&(i=1),this.blood<=0||(this.blood-=i,this.blood<=0?(c.single().unscheduleAllCallBacksForTarget(this),i<r.TANK_MAX_HP&&this._audioMng.playAudio("tank_bomb",!1),this.stopAnimation(),this.canMove=!1,this.getComponent(o).play("blast")):(this._audioMng.playAudio("bin_tank",!1),this.playAnimation("moving")),this.isProp&&i<r.TANK_MAX_HP&&this.mapLayer.createProp())},n.onDestroyed=function(){this.mapLayer.destoryEnemy(this.node)},n._autoMoving=function(i){var t=this.node.position,s=t.x,n=t.y,e=a(s,n);switch(this.dir){case l.LEFT:s-=i;break;case l.UP:n+=i;break;case l.RIGHT:s+=i;break;case l.DOWN:n-=i}this.node.setPosition(s,n),this._curDistance+=i,(this._isCollisionWithMap()||this._isCollisionWithBlock()||this._isCollisionWithTank())&&(this.node.position=e,this._curDistance=this._maxDistance)},s}(h))||u);s._RF.pop()}}}));

System.register("chunks:///_virtual/Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UpdateInformations.ts","./AudioMng.ts","./Globals.ts","./Math.ts"],(function(e){"use strict";var t,n,a,i,o,r,s,l,c,u,h,g,m,p,d,f,v,y,C,A,_,L,b,w,M,E,S,T,F,G;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.createClass},function(e){r=e.cclegacy,s=e._decorator,l=e.Prefab,c=e.CCInteger,u=e.TweenSystem,h=e.Scheduler,g=e.EventTarget,m=e.find,p=e.Camera,d=e.Color,f=e.view,v=e.UITransformComponent,y=e.tween,C=e.v3,A=e.game,_=e.macro,L=e.instantiate,b=e.UITransform,w=e.Label,M=e.Component},function(e){E=e.default},function(e){S=e.default},function(e){T=e.GameMode,F=e.Globals},function(e){G=e.Random}],execute:function(){var I,P,O,R,k,U,x,z,B;r._RF.push({},"0fc083YdIFOSL3n1ahU6QI9","Game",void 0);var N=s.ccclass,V=s.property,D=s.executionOrder;e("default",(I=D(-1),P=V(l),O=V(c),R=V({type:c,min:1,max:36}),N(k=I(((B=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,a(t,"black",x,i(t)),a(t,"_level",z,i(t)),t._gameMode=T.ONE,t.actionManager=(new u).ActionManager,t.scheduler=new h,t.gameEvent=new g,t.mapLayer=null,t.gameLayer=null,t.stageArea=null,t.gameover=!1,t}n(t,e),t.single=function(){return t.instance};var r=t.prototype;return r.gameStart=function(){m("/Game/AudioMng").getComponent(S).playAudio("game_start"),m("/Canvas/GameLayer").active=!1,m("/Canvas/StageArea").active=!1,m("/Canvas/Camera").getComponent(p).clearColor=new d(100,100,100),this.showAnimation()},r.gameOver=function(){var e=this;this.gameover=!0,this.scheduler.unscheduleAll();var t=f.getVisibleSize(),n=m("/Canvas/External/gameover_up");n.setPosition(0,-t.height/2-n.getComponent(v).height/2);var a=y(n).to(1.5,{position:C(0,0)}).delay(.5).call((function(){m("/Game/AudioMng").getComponent(S).playAudio("game_over"),m("/Canvas/GameLayer").active=!1,m("/Canvas/External/gameover_left").active=!1,m("/Canvas/External/gameover_up").active=!1,e.mapLayer._cleanChildNode(),m("/Canvas/Camera").getComponent(p).clearColor=new d(0,0,0),m("/Canvas/External/big_gameover").setPosition(0,0)}));this.runAction(a)},r.onLoad=function(){G.setSeed(10265016),t.instance?this.node.destroy():(t.instance=this,A.addPersistRootNode(this.node)),this.gameLayer=m("/Canvas/GameLayer"),this.mapLayer=this.gameLayer.getChildByName("MapLayer").getComponent("MapLayer"),this.stageArea=m("/Canvas/StageArea")},r.start=function(){this.gameStart()},r.runAction=function(e){if(!e||!e._target)return e;null!=e&&e._finalAction&&this.actionManager.removeAction(e._finalAction),e._finalAction=e._union(),e._finalAction.setTag(e._tag),this.actionManager.addAction(e._finalAction,e._target,!1)},r.stopAction=function(e){null!=e&&e._finalAction&&this.actionManager.removeAction(e._finalAction)},r.gameLoop=function(){this.actionManager.update(.018),this.scheduler.update(.018),this.mapLayer.onUpdate(.02)},r.scheduleOne=function(e,t,n){h.enableForTarget(t),this.scheduler.schedule(e,t,0,0,n,!1)},r.scheduleForever=function(e,t,n,a){void 0===a&&(a=0),h.enableForTarget(t),this.scheduler.schedule(e,t,n,_.REPEAT_FOREVER,a,!1)},r.unscheduleCallBackForTarget=function(e,t){this.scheduler.unschedule(e,t)},r.unscheduleAllCallBacksForTarget=function(e){this.scheduler.unscheduleAllForTarget(e)},r.getRandInt=function(e,t){return G.getUniformInt(e,t)},r.getRandom=function(){return G.getUniform()},r.onUpdate=function(e,t){},r.update=function(){this.gameLoop()},r.showAnimation=function(){var e=this,t=f.getVisibleSize(),n=L(this.black);n.getComponent(b).width=t.width,n.setPosition(0,t.height/2+n.getComponent(b).height/2);var a=L(this.black);a.getComponent(b).width=t.width,a.setPosition(0,-(t.height/2+a.getComponent(b).height/2));var i=m("/Canvas");n.parent=i,a.parent=i;var o=y(n).to(.5,{position:C(0,t.height/4)}).call((function(){n.destroy()})),r=y(a).to(.5,{position:C(0,-t.height/4)}).call((function(){a.destroy(),e.showStage()}));this.runAction(o),this.runAction(r)},r.showStage=function(){var e=this;this.stageArea.active=!0,this.stageArea.getChildByName("level").getComponent(w).string=this._level.toString(),this.mapLayer.init(),this.scheduleOne((function(){e.stageArea.active=!1,e.gameLayer.active=!0,e.gameLayer.getChildByName("Informations").getComponent(E).init(e._level),e.mapLayer.spawn()}),this,.5)},o(t,[{key:"level",get:function(){return this._level},set:function(e){e>F.MAX_LEVEL&&(e-=F.MAX_LEVEL),this._level=e}}]),t}(M)).instance=null,x=t((U=B).prototype,"black",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(U.prototype,"_level",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),t(U.prototype,"level",[R],Object.getOwnPropertyDescriptor(U.prototype,"level"),U.prototype),k=U))||k)||k));r._RF.pop()}}}));

System.register("chunks:///_virtual/GameRoot.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts"],(function(e){"use strict";var o,t,r,i,n,a,c,u,s,l,p;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,c=e.AudioSource,u=e.assert,s=e.game,l=e.Component},function(e){p=e.AudioManager}],execute:function(){var d,f,g,h,m;n._RF.push({},"4e4d4qcpPxF7bbHgwfvL1+j","GameRoot",void 0);var y=a.ccclass,v=a.property;e("GameRoot",(d=y("GameRoot"),f=v(c),d((m=o((h=function(e){function o(){for(var o,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return o=e.call.apply(e,[this].concat(n))||this,r(o,"_audioSource",m,i(o)),o}return t(o,e),o.prototype.onLoad=function(){var e=this.getComponent(c);u(e),this._audioSource=e,s.addPersistRootNode(this.node),p.instance.init(e)},o}(l)).prototype,"_audioSource",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=h))||g));n._RF.pop()}}}));

System.register("chunks:///_virtual/Globals.ts",["cc"],(function(E){"use strict";var T,_;return{setters:[function(E){T=E.cclegacy,_=E.v2}],execute:function(){var N,O;E({Dir:void 0,GameMode:void 0}),T._RF.push({},"39542xNIj1EArDi5+E63VT5","Globals",void 0),function(E){E[E.LEFT=0]="LEFT",E[E.UP=1]="UP",E[E.RIGHT=2]="RIGHT",E[E.DOWN=3]="DOWN"}(N||(N=E("Dir",{}))),function(E){E[E.ONE=0]="ONE",E[E.MORE=1]="MORE"}(O||(O=E("GameMode",{})));E("Globals",{BLOCK_SIZE:8,TANK_SIZE:16,MAP_HEIGHT:208,MAP_WIDTH:208,BULLET_SIZE:4,TB_INIT_POWER:0,TB_FAST_POWER:1,TB_DOUBLE_POWER:2,TB_STONE_POWER:3,TB_FOREST_POWER:4,ENEMIES_COUNT:10,TANK_MAX_HP:10,ENEMY1:_(8,200),ENEMY2:_(104,200),ENEMY3:_(200,200),PLAYER1:_(80,8),FENCE_EMPTY:0,FENCE_WALL:1,FENCE_STONE:2,MAX_LEVEL:36,Z:{FOREST:5,TANK:4,BULLET:3,OTHERS:2,ICE:1}});T._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioManager.ts","./AudioMng.ts","./BaseTank.ts","./BlockCamp.ts","./BlockWall.ts","./Bullet.ts","./EnemyTank.ts","./Game.ts","./MapLayer.ts","./PlayerTank.ts","./Prop.ts","./TouchControl.ts","./UpdateInformations.ts","./Utils.ts","./GameRoot.ts","./Globals.ts","./Math.ts","./Menu.ts","./colyseus.mjs_cjs=&original=.js"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MapLayer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Game.ts","./Globals.ts","./Bullet.ts","./EnemyTank.ts","./BlockWall.ts","./UpdateInformations.ts","./AudioMng.ts","./PlayerTank.ts","./Prop.ts"],(function(e){"use strict";var t,n,i,o,l,r,a,s,c,u,h,p,m,f,b,g,d,v,y,_,k,E,C,w,A,B,N,P,T,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.initializerDefineProperty,i=e.inheritsLoose,o=e.assertThisInitialized,l=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,a=e._decorator,s=e.SpriteFrame,c=e.Node,u=e.Prefab,h=e.instantiate,p=e.find,m=e.NodePool,f=e.tween,b=e.Sprite,g=e.Vec3,d=e.assetManager,v=e.TextAsset,y=e.UITransform,_=e.Rect,k=e.Component},function(e){E=e.default},function(e){C=e.Globals},function(e){w=e.default},function(e){A=e.default},function(e){B=e.default},function(e){N=e.default},function(e){P=e.default},function(e){T=e.default},function(e){M=e.default}],execute:function(){var z,F,S,I,x,U,L,O,D,K,Y,R,G,Z,H,W,V,j,J,Q,X,q,$,ee,te,ne,ie,oe,le,re,ae,se,ce,ue,he,pe,me,fe,be,ge,de,ve,ye;r._RF.push({},"d4da5EDAJVK9YMNxwzHxYKQ","MapLayer",void 0);var _e=a.ccclass,ke=a.property,Ee=(a.executionOrder,z=_e("BlockData"),F=ke({tooltip:"块名",visible:!0}),S=ke({type:s,tooltip:"块帧",visible:!0}),z((U=t((x=function(){n(this,"blockName",U,this),n(this,"blockFrame",L,this)}).prototype,"blockName",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),L=t(x.prototype,"blockFrame",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=x))||I);e("default",(O=ke(c),D=ke(c),K=ke(c),Y=ke(c),R=ke(c),G=ke(c),Z=ke(c),H=ke(u),W=ke(u),V=ke(u),j=ke(u),J=ke(u),Q=ke(u),X=ke(u),q=ke(u),$=ke(u),ee=ke([Ee]),_e((ie=t((ne=function(e){function t(){for(var t,i=arguments.length,l=new Array(i),r=0;r<i;r++)l[r]=arguments[r];return t=e.call.apply(e,[this].concat(l))||this,n(t,"front_blocks",ie,o(t)),n(t,"players",oe,o(t)),n(t,"enemies",le,o(t)),n(t,"blocks",re,o(t)),n(t,"enemiesBullets",ae,o(t)),n(t,"playerBullets",se,o(t)),n(t,"props",ce,o(t)),n(t,"blockWall",ue,o(t)),n(t,"blockStone",he,o(t)),n(t,"blockForest",pe,o(t)),n(t,"blockIce",me,o(t)),n(t,"blockRiver",fe,o(t)),n(t,"player1",be,o(t)),n(t,"enemy",ge,o(t)),n(t,"bullet",de,o(t)),n(t,"prop",ve,o(t)),n(t,"fenceBlockDatas",ye,o(t)),t.blockTrans=new Array,t._game=void 0,t._audioMng=void 0,t._bulletPool=void 0,t._enemiesPool=void 0,t._propPool=void 0,t._remainEnemiesCount=void 0,t._pause=!1,t._revertAction=null,t}i(t,e);var r=t.prototype;return r.createBullet=function(e,t,n,i,o){var l;(void 0===o&&(o=0),i.bulletCount<=0)||(l=this._bulletPool.size()>0?this._bulletPool.get():h(this.bullet),i.isEnemy?l.parent=this.enemiesBullets:(this._audioMng.playAudio("shoot",!1),l.parent=this.playerBullets),l.getComponent(w).init(e,t,n,i,o))},r.destoryBullet=function(e){this._bulletPool.put(e)},r.destoryEnemy=function(e){this._enemiesPool.put(e)},r.destoryProp=function(e){this._propPool.put(e)},r.init=function(){this._pause=!1,this._remainEnemiesCount=C.ENEMIES_COUNT,this._cleanChildNode(),this._loadMap()},r.spawn=function(){this.spawnNewEnemy();for(var e,t=l(this.players.children);!(e=t()).done;){e.value.getComponent(T).reset()}this._game.scheduleForever(this.spawnNewEnemy,this,.5),this._game.scheduleForever(this.checkLevelUp,this,.1)},r.checkLevelUp=function(){0==this.enemies.children.length&&0==this._remainEnemiesCount&&this._game.scheduleOne(this.toNextStage,this,2)},r.onUpdate=function(e){for(var t,n=l(this.players.children);!(t=n()).done;){t.value.getComponent(T).onUpdate(e)}for(var i=this.enemies.children.length-1;i>=0;i--){this.enemies.children[i].getComponent(A).onUpdate(e)}for(var o=this.playerBullets.children.length-1;o>=0;o--){this.playerBullets.children[o].getComponent(w).onUpdate(e)}for(var r=this.enemiesBullets.children.length-1;r>=0;r--){this.enemiesBullets.children[r].getComponent(w).onUpdate(e)}for(var a=this.props.children.length-1;a>=0;a--){this.props.children[a].getComponent(M).onUpdate(e)}},r.onLoad=function(){this._game=E.single(),this._audioMng=p("/Game/AudioMng").getComponent(P),this._bulletPool=new m,this._enemiesPool=new m,this._propPool=new m,this.spawnPlayer(),this._game.gameEvent.on("bomb",this.killAllEnemy,this),this._game.gameEvent.on("pause",this.pauseAllEnemy,this),this._game.gameEvent.on("fence",this.reinforceFence,this)},r.isAIPaused=function(){return this._pause},r.pauseAllEnemy=function(e){this._pause=!0;for(var t,n=l(this.enemies.children);!(t=n()).done;){t.value.getComponent(A).pause()}this._game.unscheduleCallBackForTarget(this.resumeAllEnemy,this),this._game.scheduleOne(this.resumeAllEnemy,this,8)},r.resumeAllEnemy=function(){for(var e,t=l(this.enemies.children);!(e=t()).done;){e.value.getComponent(A).resume()}this._pause=!1},r.killAllEnemy=function(e){p("/Game/AudioMng").getComponent(P).playAudio("tank_bomb",!1);for(var t,n=l(this.enemies.children);!(t=n()).done;){var i=t.value.getComponent(A);i.isStar||i.disBlood(C.TANK_MAX_HP)}},r.reinforceFence=function(e){this.changeFence(C.FENCE_STONE),E.single().stopAction(this._revertAction),E.single().unscheduleCallBackForTarget(this.revertFence,this),E.single().scheduleOne(this.revertFence,this,5)},r.revertFence=function(){var e=this;this._revertAction=f(this);for(var t=function(t){e._revertAction.delay(.3).call((function(){return e.changeFence(t%2+1)}))},n=0;n<7;n++)t(n);E.single().runAction(this._revertAction)},r.changeFence=function(e){for(var t=0,n=[{line:0,col:11},{line:1,col:11},{line:2,col:11},{line:2,col:12},{line:2,col:13},{line:0,col:14},{line:1,col:14},{line:2,col:14}];t<n.length;t++){var i,o,l=n[t],r=l.line,a=l.col,s=null==(i=this.blockTrans[r][a])?void 0:i.node;if(s)null==(o=s.getComponent(B))||o.init(),s.name=this.fenceBlockDatas[e].blockName,s.getComponent(b).spriteFrame=this.fenceBlockDatas[e].blockFrame}},r.spawnNewEnemy=function(){if(!(this.enemies.children.length>=100||this._remainEnemiesCount<=0))if(this._remainEnemiesCount==C.ENEMIES_COUNT)this.createEnemy(C.ENEMY1),this.createEnemy(C.ENEMY2),this.createEnemy(C.ENEMY3);else if(this._remainEnemiesCount>0){var e,t=Math.floor(this._game.getRandInt(0,2));e=0==t?C.ENEMY1:1==t?C.ENEMY2:C.ENEMY3,this.createEnemy(e)}},r.spawnPlayer=function(){h(this.player1).parent=this.players},r.createEnemy=function(e){var t;(t=this._enemiesPool.size()>0?this._enemiesPool.get():h(this.enemy)).parent=this.enemies,t.getComponent(A).init(new g(e.x,e.y)),p("/Canvas/GameLayer/Informations").getComponent(N).deleteOneIcon(),this._remainEnemiesCount--},r.createProp=function(){var e;(e=this._propPool.size()>0?this._propPool.get():h(this.prop)).parent=this.props,e.getComponent(M).init()},r.toNextStage=function(){this._game.level=this._game.level+1,this._game.unscheduleAllCallBacksForTarget(this),this._game.stopAction(this._revertAction);for(var e,t=l(this.players.children);!(e=t()).done;){var n=e.value;n.getComponent(T).controlStop(),n.getComponent(T).canMove=!1}this._game.gameover||this._game.gameStart()},r._loadMap=function(){var e=this;this.blockTrans=new Array(26),d.loadBundle("maps",(function(t,n){n.load(e._game.level.toString(),v,(function(t,n){for(var i=n.text,o=0,l=0;26!=l;l++){e.blockTrans[25-l]=new Array(26);for(var r=0;26!=r;r++){var a=void 0;switch(i[o++]){case"3":(a=h(e.blockWall)).name="block_wall",a.getComponent(B).init();break;case"5":(a=h(e.blockStone)).name="block_stone";break;case"1":(a=h(e.blockForest)).name="block_forest";break;case"2":a=h(e.blockIce);break;case"4":(a=h(e.blockRiver)).name="block_river"}a?("block_forest"!=a.name?a.parent=e.blocks:a.parent=e.front_blocks,a.getComponent(y).setAnchorPoint(0,0),a.setPosition(r*C.BLOCK_SIZE,(25-l)*C.BLOCK_SIZE),e.blockTrans[25-l][r]=a.getComponent(y)):e.blockTrans[25-l][r]=null}}var s=e.blocks.children[0].getComponent(y);e.blockTrans[0][12]=s,e.blockTrans[0][13]=s,e.blockTrans[1][12]=s,e.blockTrans[1][13]=s}))}))},r._canSpawnTank=function(e){for(var t,n=new _(e.x-C.TANK_SIZE/2,e.y-C.TANK_SIZE/2,C.TANK_SIZE,C.TANK_SIZE),i=this.enemies.children,o=this.players.children,r=l(i);!(t=r()).done;){var a=t.value;if(n.intersects(a.getComponent(y).getBoundingBox()))return!1}for(var s,c=l(o);!(s=c()).done;){var u=s.value;if(n.intersects(u.getComponent(y).getBoundingBox()))return!1}return!0},r._cleanChildNode=function(){for(var e=this.enemies.children.length-1;e>=0;e--)this.destoryEnemy(this.enemies.children[e]);for(var t=this.playerBullets.children.length-1;t>=0;t--){var n=this.playerBullets.children[t];n.getComponent(w)._stopAnimation(),n.getComponent(w).stopMoving||n.getComponent(w).tank.bulletCount++,this.destoryBullet(n)}for(var i=this.enemiesBullets.children.length-1;i>=0;i--){var o=this.enemiesBullets.children[i];o.getComponent(w)._stopAnimation(),o.getComponent(w).stopMoving||o.getComponent(w).tank.bulletCount++,this.destoryBullet(o)}for(var l=this.blocks.children.length-1;l>=0;l--)"camp"!=this.blocks.children[l].name&&this.blocks.children[l].destroy();for(var r=this.front_blocks.children.length-1;r>=0;r--)this.front_blocks.children[r].destroy();for(var a=this.props.children.length-1;a>=0;a--)this.destoryProp(this.props.children[a])},t}(k)).prototype,"front_blocks",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=t(ne.prototype,"players",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=t(ne.prototype,"enemies",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=t(ne.prototype,"blocks",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=t(ne.prototype,"enemiesBullets",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(ne.prototype,"playerBullets",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=t(ne.prototype,"props",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(ne.prototype,"blockWall",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=t(ne.prototype,"blockStone",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=t(ne.prototype,"blockForest",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=t(ne.prototype,"blockIce",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=t(ne.prototype,"blockRiver",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=t(ne.prototype,"player1",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=t(ne.prototype,"enemy",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=t(ne.prototype,"bullet",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=t(ne.prototype,"prop",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=t(ne.prototype,"fenceBlockDatas",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),te=ne))||te));r._RF.pop()}}}));

System.register("chunks:///_virtual/Math.ts",["cc"],(function(t){"use strict";var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"fa24507DT9Hlo4q1nfzt8rS","Math",void 0);t("Random",{getSeed:function(){return this._seed},setSeed:function(t){return t=t<1?1/t:t,this._seed=t,this._s0=(t>>>0)*this._frac,t=69069*t+1>>>0,this._s1=t*this._frac,t=69069*t+1>>>0,this._s2=t*this._frac,this._c=1,this},getUniform:function(){var t=2091639*this._s0+this._c*this._frac;return this._s0=this._s1,this._s1=this._s2,this._c=0|t,this._s2=t-this._c,this._s2},getUniformInt:function(t,n){var r=Math.max(t,n),i=Math.min(t,n);return Math.floor(this.getUniform()*(r-i+1))+i},getNormal:function(t,n){do{var r=2*this.getUniform()-1,i=2*this.getUniform()-1,s=r*r+i*i}while(s>1||0==s);return(t||0)+r*Math.sqrt(-2*Math.log(s)/s)*(n||1)},getPercentage:function(){return 1+Math.floor(100*this.getUniform())},getWeightedValue:function(t){var n=0;for(var r in t)n+=t[r];var i=this.getUniform()*n,s=0;for(var r in t)if(i<(s+=t[r]))return r;return r},getState:function(){return[this._s0,this._s1,this._s2,this._c]},setState:function(t){return this._s0=t[0],this._s1=t[1],this._s2=t[2],this._c=t[3],this},clone:function(){var t=Object.create(this);return t.setState(this.getState()),t},_s0:0,_s1:0,_s2:0,_c:0,_frac:2.3283064365386963e-10});var r=Math.PI;t("Trigfill",function(){var t=r,n=2*t,i=t/2,s=t/4,e=t/6,a=t/8,h=1.7320508075688772;function o(t,n){return t-Math.floor(t/n)*n}function u(r){if((r-=Math.floor(r/n)*n)>t&&(r=n-r),r>=i){var e=-1;r=t-r}else e=1;return r>s?e*_(i-r):e*f(r)}function c(r){if((r-=Math.floor(r/n)*n)>t){var e=-1;r-=t}else e=1;return r>=i&&(r=t-r),r>s?e*f(i-r):e*_(r)}function f(t){var n=t*t,r=n*n;return 1-.5*n+.04166668402778501*r-r*n*.0013889202167560002+r*r*2464354164363009e-20}function _(t){var n=t*t*t,r=n*n;return t-.1666666652777778*n+n*t*t*.008333333333333333-r*t*.00019842529684424408+r*n*2755671171270475e-21}function v(t){var n=1,r=!1,s=!1;t<0&&(n=-1,t=-t),t>1&&(t=1/t,r=!0),t>.26794919&&(t=(h*t-1)/(h+t),s=!0);var a=t*t,o=a*a,u=o*o*t;return t=t-t*a*.3333333342477778+o*t*.19999967200053792-o*a*t*.14285489799446008+.11108765927193148*u-u*a*.0849762066621346,s&&(t+=e),r&&(t=i-t),t*n}function M(r,s){if(0===s)return 0===r?0:r<0?-i:i;var e=v(r/s);return s>0?e:(r<0?e-=t:e+=t,e-Math.floor(e/n+.5)*n)}function g(n){var r=1,e=!1,h=!1;(n=.9999999999999999*o(n,t))>i&&(n=t-n,r=-1),n>s&&(n=i-n,e=!0),n>a&&(n*=.5,h=!0);var u=n*n,c=u*u,f=c*c*n;return n=n+n*u*.33333334588888935+c*n*.1333332730666939+c*u*n*.05396042542399404+.02191788570176121*f+f*u*.009447247173345365,h&&(n=2*n/(1-n*n)),e&&(n=1/n),n*r}function l(t){return-1==t?r:o(v(Math.sqrt(1-t*t)/t),r)}function m(t){return v(t/Math.sqrt(1-t*t))}return{sin:c,cos:u,tan:g,acos:l,asin:m,atan:v,atan2:M,modp:o,modn:function(t,n){return t-Math.floor(t/n+.5)*n},setmaths:function(){Math.sin=c,Math.cos=u,Math.tan=g,Math.acos=l,Math.asin=m,Math.atan=v,Math.atan2=M},version:function(){return"0.9.5"}}}()).setmaths(),n._RF.pop()}}}));

System.register("chunks:///_virtual/Menu.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){"use strict";var e,t,o,c,r;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,o=n._decorator,c=n.director,r=n.Component}],execute:function(){var u;t._RF.push({},"d6228iQ9ctJH6L5jG/TGk+b","Menu",void 0);var i=o.ccclass;n("default",i(u=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var o=t.prototype;return o.onLoad=function(){c.preloadScene("game")},o.onBtnOne=function(){c.loadScene("game")},o.onBtnMore=function(){},t}(r))||u);t._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerTank.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseTank.ts","./Globals.ts","./UpdateInformations.ts","./Game.ts"],(function(i){"use strict";var t,e,s,n,o,a,h,l,r,c,u,_,d,m,p,v,f,g,y,D,E;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,s=i.initializerDefineProperty,n=i.assertThisInitialized},function(i){o=i.cclegacy,a=i._decorator,h=i.Node,l=i.Animation,r=i.view,c=i.find,u=i.UITransform,_=i.tween,d=i.v3,m=i.input,p=i.Input,v=i.KeyCode},function(i){f=i.default},function(i){g=i.Globals,y=i.Dir},function(i){D=i.default},function(i){E=i.default}],execute:function(){var b,M,k,T;o._RF.push({},"87f4evuCkVLg70Hoxm1N+sJ","PlayerTank",void 0);var C=a.ccclass,O=a.property;i("default",(b=O(h),C((T=t((k=function(i){function t(){for(var t,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return t=i.call.apply(i,[this].concat(o))||this,s(t,"ring",T,n(t)),t._isInvincible=void 0,t._memDirs=[],t._ui=null,t._autoShooting=void 0,t}e(t,i);var o=t.prototype;return o.control=function(i){this.canMove&&(this.autoMoving||this._audioMng.playAudio("player_move",!0),this._setDir(i),this._playAnimation("moving"),this.autoMoving=!0)},o.controlStop=function(){this.canMove&&(this.autoMoving=!1,this._audioMng.stopAudio("player_move"),this._playAnimation("idle"))},o.shoot=function(){this.canMove&&this.mapLayer.createBullet(this.dir,this.node.position,Math.min(5,2*(this.level+1)),this,this.level)},o.disBlood=function(){this._isInvincible||this.level>=g.TB_STONE_POWER||(this.blood=0,this.life--,this.life>=0&&(this._audioMng.playAudio("tank_bomb",!1),this.controlStop(),this.canMove=!1,this._isInvincible=!0,this.getComponent(l).play("blast")),0!=this.life?(E.single().unscheduleCallBackForTarget(this.reset,this),E.single().scheduleOne(this.reset,this,.6)):this.gameOver(),this.life>0&&this._ui.updatePlayerBlood(this.life-1))},o.gameOver=function(){this.node.active=!1,this._audioMng.stopAudio("player_move");var i=r.getVisibleSize(),t=c("/Canvas/External/gameover_left");t.active=!0,t.setPosition(-i.width/2-t.getComponent(u).width/2,-94),_(t).to(1.5,{position:d(-35,-94)}).delay(1).call((function(){c("/Game").getComponent(E).gameOver()})).start()},o.reset=function(){this.isStar=!0,this.getComponent(l).play("star"),this.canMove=!1,this.blood=1,this._isInvincible=!0,this._setDir(y.UP),this.node.setPosition(80,8),this._ui.updatePlayerBlood(this.life-1),E.single().unscheduleCallBackForTarget(this.afterStar,this),E.single().scheduleOne(this.afterStar,this,.6)},o.onLoad=function(){i.prototype.onLoad.call(this),this.life=60,this.isEnemy=!1,this._ui=c("/Canvas/GameLayer/Informations").getComponent(D),this.mapLayer=c("/Canvas/GameLayer/MapLayer").getComponent("MapLayer"),m.on(p.EventType.KEY_DOWN,this._onKeyDown,this),m.on(p.EventType.KEY_UP,this._onKeyUp,this),E.single().gameEvent.on("power",this.changeLevel,this),E.single().gameEvent.on("life",this.addLife,this),E.single().gameEvent.on("invincible",this.invicible,this)},o.invicible=function(i){i==this.node&&(this._isInvincible=!0,this.ring.active=!0,this.ring.getComponent(l).play("ring"),E.single().unscheduleCallBackForTarget(this.normal,this),E.single().scheduleOne(this.normal,this,10))},o.normal=function(){this.ring.getComponent(l).stop(),this._isInvincible=!1,this.ring.active=!1},o.addLife=function(){this.life++,this._audioMng.playAudio("add_life",!1),this._ui.updatePlayerBlood(this.life-1)},o.changeLevel=function(i,t){if(void 0===t&&(t=1),i==this.node){var e=this.level;this.level+=t,this._playAnimation("idle"),t>0&&this.level>=g.TB_DOUBLE_POWER&&e<g.TB_DOUBLE_POWER&&this.bulletCount++,t<0&&this.level<g.TB_DOUBLE_POWER&&e>=g.TB_DOUBLE_POWER&&this.bulletCount--}},o.afterStar=function(){this.isStar=!1,this.canMove=!0,this._playAnimation("idle"),this._memDirs.length>0&&this.control(this._memDirs[this._memDirs.length-1]),this.ring.active=!0,this.ring.getComponent(l).play("ring"),E.single().unscheduleCallBackForTarget(this.normal,this),E.single().scheduleOne(this.normal,this,3)},o.onUpdate=function(i){if(this.canMove){if(this.autoMoving){var t=40*(.1*this.level+1)*i;this._autoMoving(t)}this._autoShooting&&this.shoot()}},o._clearMemDir=function(){this._memDirs=[]},o._addMemDir=function(i){this._memDirs.includes(i)||this._memDirs.push(i)},o._onKeyDown=function(i){switch(i.keyCode){case v.KEY_A:this.control(y.LEFT),this._addMemDir(y.LEFT);break;case v.KEY_W:this.control(y.UP),this._addMemDir(y.UP);break;case v.KEY_D:this.control(y.RIGHT),this._addMemDir(y.RIGHT);break;case v.KEY_S:this.control(y.DOWN),this._addMemDir(y.DOWN);break;case v.KEY_J:this.shoot();break;case v.KEY_L:this.mapLayer.createProp();break;case v.KEY_K:this._autoShooting=!0}},o._onKeyUp=function(i){var t=-1;switch(i.keyCode){case v.KEY_A:t=this._memDirs.indexOf(y.LEFT);break;case v.KEY_W:t=this._memDirs.indexOf(y.UP);break;case v.KEY_D:t=this._memDirs.indexOf(y.RIGHT);break;case v.KEY_S:t=this._memDirs.indexOf(y.DOWN);break;case v.KEY_K:this._autoShooting=!1}if(t>=0)if(this._memDirs.splice(t,1),0==this._memDirs.length)this.controlStop();else{var e=this._memDirs.pop();this._addMemDir(e),this.control(e)}},o._playAnimation=function(i){i=i+"_"+Math.min(g.TB_STONE_POWER,this.level),this._anim.play(i)},o._setDir=function(i){if(this.dir!=i){var t=d(this.node.position);this._adjustPosition(),(this._isCollisionWithMap()||this._isCollisionWithBlock()||this._isCollisionWithTank())&&(this.node.position=t),this.dir=i,this.node.angle=-90*this.dir}},o._autoMoving=function(i){var t=this.node.position,e=t.x,s=t.y,n=d(e,s);switch(this.dir){case y.LEFT:e-=i;break;case y.UP:s+=i;break;case y.RIGHT:e+=i;break;case y.DOWN:s-=i}this.node.setPosition(e,s),(this._isCollisionWithMap()||this._isCollisionWithBlock()||this._isCollisionWithTank())&&(this.node.position=n)},t}(f)).prototype,"ring",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=k))||M));o._RF.pop()}}}));

System.register("chunks:///_virtual/Prop.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Game.ts","./Globals.ts","./AudioMng.ts","./BaseTank.ts"],(function(e){"use strict";var t,n,i,o,r,s,a,c,l,p,u,h,f,d,g,m,v,y,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,a=e._decorator,c=e.SpriteFrame,l=e.find,p=e.Sprite,u=e.UIOpacity,h=e.tween,f=e.UITransform,d=e.Rect,g=e.Component},function(e){m=e.default},function(e){v=e.Globals},function(e){y=e.default},function(e){I=e.default}],execute:function(){var C,L,_,P;s._RF.push({},"17f71D0U69L6ZT0Kwj+msmw","Prop",void 0);var b=a.ccclass,A=a.property;e("default",(C=A([c]),b((P=t((_=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,i(t,"frames",P,o(t)),t.mapLayer=void 0,t.action=void 0,t.events=["life","power","pause","bomb","fence","invincible"],t.eventId=void 0,t}n(t,e);var s=t.prototype;return s.init=function(){this.mapLayer=l("/Canvas/GameLayer/MapLayer").getComponent("MapLayer"),l("/Game/AudioMng").getComponent(y).playAudio("prop_out",!1);var e=this.getComponent(p),t=m.single().getRandInt(0,this.frames.length-1);e.spriteFrame=this.frames[t],this.eventId=this.events[t];var n=m.single().getRandInt(v.BLOCK_SIZE,v.MAP_WIDTH-v.BLOCK_SIZE),i=m.single().getRandInt(v.BLOCK_SIZE,v.MAP_HEIGHT-v.BLOCK_SIZE);this.node.setPosition(n,i);var o=this.getComponent(u),r=h().to(.8,{opacity:0}).to(.8,{opacity:255});this.action=h(o).repeatForever(r),m.single().runAction(this.action),m.single().scheduleOne(this.onPropDestory,this,10)},s.onUpdate=function(e){this.check()},s._isCollisionWithPlayer=function(e){var t=this.getComponent(f).getBoundingBox();t=new d(t.xMin+2,t.yMin+2,t.width-4,t.height-4);var n=e.getComponent(f).getBoundingBox();return!!t.intersects(n)},s.check=function(){for(var e,t=r(this.mapLayer.players.children);!(e=t()).done;){var n=e.value;if(this._isCollisionWithPlayer(n))if(n.getComponent(I).blood>0){this.effective(n);break}}},s.onPropDestory=function(){m.single().stopAction(this.action),m.single().unscheduleAllCallBacksForTarget(this),this.mapLayer.destoryProp(this.node)},s.effective=function(e){"life"!=this.eventId&&l("/Game/AudioMng").getComponent(y).playAudio("get_prop",!1),console.log(""+this.eventId),m.single().gameEvent.emit(this.eventId,e),this.onPropDestory()},t}(g)).prototype,"frames",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=_))||L));s._RF.pop()}}}));

System.register("chunks:///_virtual/TouchControl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlayerTank.ts","./Globals.ts"],(function(t){"use strict";var o,n,e,i,s,a,r,c,u,h,p,l,g,d,y;return{setters:[function(t){o=t.applyDecoratedDescriptor,n=t.inheritsLoose,e=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,r=t.Node,c=t.find,u=t.sys,h=t.UITransform,p=t.v3,l=t.v2,g=t.Component},function(t){d=t.default},function(t){y=t.Dir}],execute:function(){var f,T,v,_;s._RF.push({},"fc4afO6SPZN+JZwwqo6p2xd","TouchControl",void 0);var C=a.ccclass,B=a.property;t("default",(f=B([r]),C((_=o((v=function(t){function o(){for(var o,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return o=t.call.apply(t,[this].concat(s))||this,e(o,"buttons",_,i(o)),o._player=null,o._node=null,o}n(o,t);var s=o.prototype;return s.onLoad=function(){this._node=c("/Canvas"),this._player=c("/Canvas/GameLayer/MapLayer/players").children[0].getComponent(d),u.isMobile?this.node.active=!0:this.node.active=!1},s.onEnable=function(){this._node.on(r.EventType.TOUCH_START,this.onTouchStart,this,!0),this._node.on(r.EventType.TOUCH_END,this.onTouchEnd,this,!0)},s.onDisable=function(){this._node.off(r.EventType.TOUCH_START,this.onTouchStart,this,!0),this._node.off(r.EventType.TOUCH_END,this.onTouchEnd,this,!0)},s.onTouchStart=function(t){var o=this._node.getComponent(h).convertToNodeSpaceAR(p(t.getUILocation().x,t.getUILocation().y));if(this.node.getComponent(h).getBoundingBox().contains(l(o.x,o.y))){var n=this.node.getComponent(h).convertToNodeSpaceAR(p(t.getUILocation().x,t.getUILocation().y)),e=l(n.x,n.y);this.buttons[0].getComponent(h).getBoundingBox().contains(e)?this._player.control(y.LEFT):this.buttons[1].getComponent(h).getBoundingBox().contains(e)?this._player.control(y.UP):this.buttons[2].getComponent(h).getBoundingBox().contains(e)?this._player.control(y.RIGHT):this.buttons[3].getComponent(h).getBoundingBox().contains(e)&&this._player.control(y.DOWN)}else this._player.shoot()},s.onTouchEnd=function(t){var o=this.node.getComponent(h).convertToNodeSpaceAR(p(t.getUILocation().x,t.getUILocation().y)),n=l(o.x,o.y);(this.buttons[0].getComponent(h).getBoundingBox().contains(n)||this.buttons[1].getComponent(h).getBoundingBox().contains(n)||this.buttons[2].getComponent(h).getBoundingBox().contains(n)||this.buttons[3].getComponent(h).getBoundingBox().contains(n))&&this._player.controlStop()},o}(g)).prototype,"buttons",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=v))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/UpdateInformations.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Globals.ts"],(function(e){"use strict";var n,t,i,o,r,a,s,l,c,u,p,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Prefab,l=e.Node,c=e.Label,u=e.instantiate,p=e.Component},function(e){m=e.Globals}],execute:function(){var f,d,h,y,I,g;r._RF.push({},"4136829pINAtptMfTJ7za9v","UpdateInformations",void 0);var v=a.ccclass,b=a.property;e("default",(f=b(s),d=b(l),v((I=n((y=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=e.call.apply(e,[this].concat(r))||this,i(n,"enemyIcon",I,o(n)),i(n,"enemiesIcon",g,o(n)),n.enemiesCount=0,n}t(n,e);var r=n.prototype;return r.deleteOneIcon=function(){this.enemiesIcon.children[this.enemiesCount-1].destroy(),this.enemiesCount--},r.updatePlayerBlood=function(e){this.node.getChildByName("player_blood").getComponent(c).string=e.toString()},r.init=function(e){this.enemiesIcon.removeAllChildren();var n=m.ENEMIES_COUNT/2;this.enemiesCount=m.ENEMIES_COUNT;for(var t=0;t!=n;t++)for(var i=0;2!=i;i++){var o=u(this.enemyIcon);o.name="icon",o.parent=this.enemiesIcon}this.node.getChildByName("cur_level").getComponent(c).string=e.toString()},n}(p)).prototype,"enemyIcon",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=n(y.prototype,"enemiesIcon",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=y))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/Utils.ts",["cc"],(function(t){"use strict";var u;return{setters:[function(t){u=t.cclegacy}],execute:function(){t("adjustNumber",(function(t){return 8*Math.round(t/8)})),u._RF.push({},"889b777L9ZAVLnYFgMSmOTF","Utils",void 0),u._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});